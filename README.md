# Sistema de Gerenciamento de Tarefas

Uma API RESTful robusta para gerenciamento de tarefas constru√≠da com Laravel Lumen, oferecendo recursos avan√ßados como exclus√£o l√≥gica (soft delete), auditoria de atividades e filtragem inteligente.

## üöÄ Caracter√≠sticas Principais

- **API RESTful Completa**: Opera√ß√µes CRUD completas para tarefas
- **Soft Delete**: Exclus√£o recuper√°vel de tarefas com possibilidade de restaura√ß√£o
- **Sistema de Auditoria**: Registros completos no MongoDB para rastreamento de atividades
- **Filtragem Avan√ßada**: Sistema robusto de filtros, ordena√ß√£o e pagina√ß√£o
- **Documenta√ß√£o OpenAPI**: Documenta√ß√£o interativa Swagger/OpenAPI 3.0
- **Tratamento de Erros**: Sistema abrangente de tratamento e valida√ß√£o de erros
- **Versionamento de API**: API versionada com suporte a m√∫ltiplas vers√µes
- **Limita√ß√£o de requisi√ß√µes**: Prote√ß√£o contra abuso da API

## üõ† Stack Tecnol√≥gica

- **Backend**: Laravel Lumen 11.x
- **PHP**: ^8.2
- **Banco de Dados Principal**: MySQL
- **Sistema de Logs**: MongoDB
- **Documenta√ß√£o**: Swagger/OpenAPI 3.0 (zircote/swagger-php)
- **Containeriza√ß√£o**: Docker e Docker Compose

## üìã Pr√©-requisitos

- **PHP** >= 8.2
- **Composer** >= 2.0
- **Docker** e **Docker Compose** (recomendado)
- **MySQL/MariaDB** >= 8.0
- **MongoDB** >= 4.0
- **Git**

## ‚ö° Instala√ß√£o R√°pida

### Op√ß√£o 1: Docker (Recomendado)

```bash
# 1. Clone o reposit√≥rio
git clone https://github.com/Jardelsr/task-management-system.git
cd task-management-system

# 2. Configure o ambiente
cp .env.example .env

# 3. Inicie os servi√ßos com Docker (a partir do diret√≥rio docker/)
cd docker/
docker-compose up -d

# 4. Execute as migra√ß√µes
docker-compose exec app php artisan migrate

# 5. Acesse a API
curl http://localhost:8000/api/v1/
```

### Op√ß√£o 2: Instala√ß√£o Manual

```bash
# 1. Clone o reposit√≥rio
git clone https://github.com/seu-usuario/task-management-system.git
cd task-management-system

# 2. Instale as depend√™ncias
composer install

# 3. Configure o ambiente
cp .env.example .env
# Edite o arquivo .env com suas configura√ß√µes

# 4. Execute as migra√ß√µes
php artisan migrate

# 5. Inicie o servidor
php -S localhost:8000 -t public
```

### Comandos Docker

```bash
# Executar a partir do diret√≥rio docker/
cd docker/
docker-compose up -d

# Ou executar da raiz do projeto
docker-compose -f docker/docker-compose.yml up -d

# Verificar status dos containers
docker-compose ps

# Ver logs
docker-compose logs app
```

## üéØ Uso da API

### Endpoints Principais

#### üìã Tarefas - Opera√ß√µes B√°sicas
| M√©todo | Endpoint | Descri√ß√£o |
|--------|----------|-----------|
| `GET` | `/api/v1/tasks` | Lista todas as tarefas |
| `POST` | `/api/v1/tasks` | Cria uma nova tarefa |
| `GET` | `/api/v1/tasks/{id}` | Obt√©m tarefa espec√≠fica |
| `PUT` | `/api/v1/tasks/{id}` | Atualiza tarefa completa |
| `PATCH` | `/api/v1/tasks/{id}` | Atualiza√ß√£o parcial |
| `DELETE` | `/api/v1/tasks/{id}` | Exclus√£o l√≥gica (soft delete) |

#### üîÑ Tarefas - Opera√ß√µes Especiais
| M√©todo | Endpoint | Descri√ß√£o |
|--------|----------|-----------|
| `POST` | `/api/v1/tasks/{id}/restore` | Restaura tarefa exclu√≠da |
| `DELETE` | `/api/v1/tasks/{id}/force` | Exclus√£o permanente |
| `POST` | `/api/v1/tasks/{id}/complete` | Marca como conclu√≠da |
| `POST` | `/api/v1/tasks/{id}/start` | Marca como em progresso |
| `POST` | `/api/v1/tasks/{id}/cancel` | Marca como cancelada |
| `POST` | `/api/v1/tasks/{id}/assign` | Atribui a um usu√°rio |
| `DELETE` | `/api/v1/tasks/{id}/assign` | Remove atribui√ß√£o |
| `POST` | `/api/v1/tasks/{id}/duplicate` | Duplica tarefa |

#### üìä Tarefas - Cole√ß√µes e Estat√≠sticas
| M√©todo | Endpoint | Descri√ß√£o |
|--------|----------|-----------|
| `GET` | `/api/v1/tasks/stats` | Estat√≠sticas das tarefas |
| `GET` | `/api/v1/tasks/summary` | Resumo das tarefas |
| `GET` | `/api/v1/tasks/trashed` | Lista tarefas exclu√≠das |
| `GET` | `/api/v1/tasks/overdue` | Lista tarefas vencidas |
| `GET` | `/api/v1/tasks/completed` | Lista tarefas conclu√≠das |
| `GET` | `/api/v1/tasks/export` | Exporta tarefas |
| `POST` | `/api/v1/tasks/bulk` | Cria m√∫ltiplas tarefas |
| `PUT` | `/api/v1/tasks/bulk` | Atualiza m√∫ltiplas tarefas |
| `DELETE` | `/api/v1/tasks/bulk` | Exclui m√∫ltiplas tarefas |

#### üìù Registros e Auditoria
| M√©todo | Endpoint | Descri√ß√£o |
|--------|----------|-----------|
| `GET` | `/api/v1/logs` | Lista logs do sistema |
| `GET` | `/api/v1/logs/{id}` | Obt√©m log espec√≠fico |
| `GET` | `/api/v1/logs/stats` | Estat√≠sticas dos logs |
| `GET` | `/api/v1/logs/recent` | Logs recentes |
| `GET` | `/api/v1/logs/export` | Exporta logs |
| `GET` | `/api/v1/logs/tasks/{id}` | Logs de uma tarefa |
| `GET` | `/api/v1/logs/actions/{action}` | Logs por a√ß√£o |
| `GET` | `/api/v1/logs/users/{userId}` | Logs por usu√°rio |
| `GET` | `/api/v1/logs/date-range` | Logs por per√≠odo |
| `DELETE` | `/api/v1/logs/cleanup` | Limpeza de logs antigos |

#### üîç Sistema e Documenta√ß√£o
| M√©todo | Endpoint | Descri√ß√£o |
|--------|----------|-----------|
| `GET` | `/` | Vis√£o geral da API |
| `GET` | `/api/v1/info` | Informa√ß√µes da API |
| `GET` | `/api/v1/health` | Status de sa√∫de |
| `GET` | `/health` | Verifica√ß√£o geral de sa√∫de do sistema |
| `GET` | `/health/database/{connection}` | Teste de conex√£o BD |
| `GET` | `/api/v1/docs` | Documenta√ß√£o interativa |
| `GET` | `/api/v1/openapi.json` | Especifica√ß√£o OpenAPI |

### Exemplos de Uso

#### Criar uma Nova Tarefa

```bash
curl -X POST http://localhost:8000/api/v1/tasks \
  -H "Content-Type: application/json" \
  -d '{
    "title": "Implementar autentica√ß√£o",
    "description": "Adicionar sistema de login e registro",
    "status": "pending",
    "due_date": "2025-12-31",
    "assigned_to": 1
  }'
```

**Resposta:**
```json
{
  "success": true,
  "message": "Task created successfully",
  "data": {
    "id": 1,
    "title": "Implementar autentica√ß√£o",
    "description": "Adicionar sistema de login e registro",
    "status": "pending",
    "due_date": "2025-12-31T00:00:00.000000Z",
    "assigned_to": 1,
    "created_at": "2025-09-22T10:30:00.000000Z",
    "updated_at": "2025-09-22T10:30:00.000000Z"
  }
}
```

#### Listar Tarefas com Filtros

```bash
# Tarefas pendentes do usu√°rio 1, ordenadas por prazo
curl "http://localhost:8000/api/v1/tasks?status=pending&assigned_to=1&sort_by=due_date&sort_order=asc"

# Tarefas vencidas com pagina√ß√£o
curl "http://localhost:8000/api/v1/tasks?overdue=true&page=1&limit=10"
```

#### Atualizar Status da Tarefa

```bash
curl -X PATCH http://localhost:8000/api/v1/tasks/1 \
  -H "Content-Type: application/json" \
  -d '{"status": "in_progress"}'
```

## üîç Sistema de Filtros

### Par√¢metros de Filtragem para Tarefas

| Par√¢metro | Tipo | Descri√ß√£o | Exemplo |
|-----------|------|-----------|---------|
| `status` | string | Status da tarefa | `?status=pending` |
| `assigned_to` | integer | ID do usu√°rio respons√°vel | `?assigned_to=1` |
| `created_by` | integer | ID do criador | `?created_by=2` |
| `overdue` | boolean | Apenas tarefas vencidas | `?overdue=true` |
| `with_due_date` | boolean | Apenas com prazo definido | `?with_due_date=true` |

### Par√¢metros de Filtragem para Logs

| Par√¢metro | Tipo | Descri√ß√£o | Exemplo |
|-----------|------|-----------|---------|
| `action` | string | Filtrar por tipo de a√ß√£o | `?action=created` |
| `task_id` | integer | Filtrar por ID da tarefa | `?task_id=1` |
| `user_id` | integer | Filtrar por ID do usu√°rio | `?user_id=1` |
| `level` | string | Filtrar por n√≠vel do log | `?level=info` |
| `source` | string | Filtrar por origem do log | `?source=api` |
| `start_date` | datetime | Data de in√≠cio (formato: Y-m-d H:i:s) | `?start_date=2025-01-01 00:00:00` |
| `end_date` | datetime | Data de fim (formato: Y-m-d H:i:s) | `?end_date=2025-12-31 23:59:59` |

### Valores V√°lidos para Filtros

#### Status de Tarefas
- `pending` - Pendente
- `in_progress` - Em andamento  
- `completed` - Conclu√≠da
- `cancelled` - Cancelada

#### A√ß√µes registradas no Log
- `created` - Cria√ß√£o
- `updated` - Atualiza√ß√£o
- `deleted` - Exclus√£o suave
- `restored` - Restaura√ß√£o
- `soft_delete` - Exclus√£o suave
- `force_delete` - Exclus√£o permanente
- `bulk_update` - Atualiza√ß√£o em lote
- `status_change` - Mudan√ßa de status
- `assignment_change` - Mudan√ßa de atribui√ß√£o
- `metadata_update` - Atualiza√ß√£o de metadados

### Par√¢metros de Ordena√ß√£o

| Par√¢metro | Valores | Padr√£o | Descri√ß√£o |
|-----------|---------|--------|-----------|
| `sort_by` | **Tarefas:** `created_at`, `updated_at`, `due_date`, `title`, `status` | `created_at` | Campo para ordena√ß√£o |
|           | **Logs:** `created_at`, `action`, `task_id`, `user_id` |  |  |
| `sort_order` | `asc`, `desc` | `desc` | Dire√ß√£o da ordena√ß√£o |

### Par√¢metros de Pagina√ß√£o

| Par√¢metro | Tipo | Padr√£o | Limite | Descri√ß√£o |
|-----------|------|--------|--------|-----------|
| `page` | integer | `1` | ‚â• 1 | P√°gina atual |
| `limit` | integer | `50` | 1-1000 | Itens por p√°gina |

### Exemplos de Consultas Avan√ßadas

#### Filtros para Tarefas
```bash
# Tarefas pendentes com prazo vencido
curl "http://localhost:8000/api/v1/tasks?status=pending&overdue=true"

# Tarefas do usu√°rio 1, ordenadas por prazo
curl "http://localhost:8000/api/v1/tasks?assigned_to=1&sort_by=due_date&sort_order=asc"

# Tarefas conclu√≠das com pagina√ß√£o
curl "http://localhost:8000/api/v1/tasks?status=completed&page=2&limit=25"
```

#### Filtros para Logs
```bash
# Logs de cria√ß√£o das √∫ltimas 24 horas
curl "http://localhost:8000/api/v1/logs?action=created&start_date=2025-09-21 00:00:00&end_date=2025-09-22 00:00:00"

# Logs de uma tarefa espec√≠fica
curl "http://localhost:8000/api/v1/logs?task_id=1&sort_by=created_at&sort_order=desc"

# Logs de erro por usu√°rio
curl "http://localhost:8000/api/v1/logs?level=error&user_id=1&limit=10"
```

## üóÇ Status de Tarefas

- `pending` - Pendente
- `in_progress` - Em andamento
- `completed` - Conclu√≠da
- `cancelled` - Cancelada

## üìä Monitoramento

### Health Check

```bash
# Verificar status da API
curl http://localhost:8000/health

# Testar conex√µes de banco
curl http://localhost:8000/health/database/mysql
curl http://localhost:8000/health/database/mongodb
```

## üõ°Ô∏è Tratamento de Erros

### C√≥digos de Status HTTP usados

- `200` - Sucesso
- `201` - Criado com sucesso
- `400` - Requisi√ß√£o inv√°lida
- `404` - Recurso n√£o encontrado
- `422` - Erro de valida√ß√£o
- `429` - Muitas requisi√ß√µes (Rate Limit)
- `500` - Erro interno do servidor

### Formato de Erro Padr√£o

```json
{
  "error": "Validation failed",
  "message": "Os dados fornecidos s√£o inv√°lidos",
  "errors": {
    "title": ["O campo t√≠tulo √© obrigat√≥rio"],
    "status": ["Status deve ser: pending, in_progress, completed, cancelled"]
  },
  "code": "VALIDATION_FAILED"
}
```

## üìö Documenta√ß√£o da API

### Swagger UI

Acesse a documenta√ß√£o interativa:

- **Local**: http://localhost:8000/api/v1/docs
- **Especifica√ß√£o OpenAPI**: http://localhost:8000/api/v1/openapi.json

### Endpoints de Documenta√ß√£o

```bash
# Informa√ß√µes da API
curl http://localhost:8000/api/v1/info

# Especifica√ß√£o OpenAPI completa
curl http://localhost:8000/api/v1/openapi.json
```

## üß™ Testes

### Executar Testes

```bash
# Testes unit√°rios
./vendor/bin/phpunit

# Testes com Docker
docker-compose exec app ./vendor/bin/phpunit

# Testes espec√≠ficos
./vendor/bin/phpunit --filter TaskTest
```

### Valida√ß√£o da API

```bash
# Executar suite de testes de valida√ß√£o
php test_api_validation_formatting.php

# Testar tratamento de erros
php test_comprehensive_error_handling.php
```

## üîß Desenvolvimento

### Estrutura do Projeto

```
‚îú‚îÄ‚îÄ app/                          # C√≥digo da aplica√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ Console/                  # Comandos Artisan personalizados
‚îÇ   ‚îú‚îÄ‚îÄ Exceptions/               # Exce√ß√µes customizadas
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TaskNotFoundException.php
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TaskValidationException.php
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ DatabaseException.php
‚îÇ   ‚îú‚îÄ‚îÄ Http/                     # Camada HTTP
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Controllers/          # Controllers da API
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TaskController.php
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LogController.php
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ApiDocumentationController.php
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Middleware/           # Middlewares customizados
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Requests/             # Valida√ß√£o de requisi√ß√µes
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CreateTaskRequest.php
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ UpdateTaskRequest.php
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ValidationHelper.php
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Responses/            # Formatadores de resposta
‚îÇ   ‚îú‚îÄ‚îÄ Models/                   # Models Eloquent & MongoDB
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Task.php             # Model principal de tarefas
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Log.php              # Model de logs (MongoDB)
‚îÇ   ‚îú‚îÄ‚îÄ OpenApi/                  # Anota√ß√µes OpenAPI/Swagger
‚îÇ   ‚îú‚îÄ‚îÄ Providers/                # Service Providers
‚îÇ   ‚îú‚îÄ‚îÄ Repositories/             # Repositories para abstra√ß√£o de dados
‚îÇ   ‚îú‚îÄ‚îÄ Services/                 # Servi√ßos de neg√≥cio
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ValidationMessageService.php
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ LoggingService.php
‚îÇ   ‚îî‚îÄ‚îÄ Traits/                   # Traits reutiliz√°veis
‚îú‚îÄ‚îÄ bootstrap/                    # Inicializa√ß√£o da aplica√ß√£o
‚îú‚îÄ‚îÄ config/                       # Arquivos de configura√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ api.php                  # Configura√ß√µes da API
‚îÇ   ‚îú‚îÄ‚îÄ database.php             # Configura√ß√µes de banco de dados
‚îÇ   ‚îú‚îÄ‚îÄ mongo.php                # Configura√ß√µes MongoDB
‚îÇ   ‚îú‚îÄ‚îÄ logging.php              # Configura√ß√µes de logging
‚îÇ   ‚îî‚îÄ‚îÄ validation_messages.php  # Mensagens de valida√ß√£o
‚îú‚îÄ‚îÄ database/                     # Database related files
‚îÇ   ‚îî‚îÄ‚îÄ migrations/              # Migra√ß√µes do banco MySQL
‚îú‚îÄ‚îÄ docs/                         # Documenta√ß√£o adicional
‚îÇ   ‚îú‚îÄ‚îÄ api-filtering-guide.md
‚îÇ   ‚îú‚îÄ‚îÄ soft-delete-implementation.md
‚îÇ   ‚îú‚îÄ‚îÄ enhanced-response-formatting.md
‚îÇ   ‚îî‚îÄ‚îÄ restful-routes-configuration.md
‚îú‚îÄ‚îÄ public/                       # Arquivos p√∫blicos
‚îÇ   ‚îú‚îÄ‚îÄ index.php                # Entry point da aplica√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ swagger-ui/              # Interface Swagger UI
‚îÇ   ‚îî‚îÄ‚îÄ .htaccess               # Configura√ß√µes Apache
‚îú‚îÄ‚îÄ resources/                    # Recursos da aplica√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ lang/                    # Arquivos de idioma
‚îÇ   ‚îî‚îÄ‚îÄ views/                   # Views (se houver)
‚îú‚îÄ‚îÄ routes/                       # Defini√ß√µes de rotas
‚îÇ   ‚îî‚îÄ‚îÄ web.php                  # Rotas da aplica√ß√£o
‚îú‚îÄ‚îÄ storage/                      # Arquivos de storage
‚îÇ   ‚îú‚îÄ‚îÄ cache/                   # Cache da aplica√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ framework/               # Framework files
‚îÇ   ‚îú‚îÄ‚îÄ logs/                    # Log files
‚îÇ   ‚îî‚îÄ‚îÄ test_outputs/            # Outputs de testes
‚îú‚îÄ‚îÄ tests/                        # Testes automatizados
‚îú‚îÄ‚îÄ vendor/                       # Depend√™ncias Composer
‚îú‚îÄ‚îÄ .env                         # Vari√°veis de ambiente
‚îú‚îÄ‚îÄ .env.example                 # Exemplo de vari√°veis de ambiente
‚îú‚îÄ‚îÄ composer.json                # Depend√™ncias e autoload
‚îú‚îÄ‚îÄ composer.lock               # Lock das vers√µes
‚îú‚îÄ‚îÄ artisan                     # CLI do Laravel
‚îú‚îÄ‚îÄ docker/                       # Configura√ß√£o Docker
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.yml       # Orquestra√ß√£o de containers  
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile               # Imagem da aplica√ß√£o
‚îÇ   ‚îî‚îÄ‚îÄ apache-vhost.conf        # Configura√ß√£o Apache
‚îî‚îÄ‚îÄ README-PT.md                # Este arquivo
```

### Arquivos Principais

#### **Configura√ß√£o**
- `composer.json` - Depend√™ncias do projeto
- `.env` - Vari√°veis de ambiente
- `artisan` - CLI do Laravel/Lumen
- `docker/docker-compose.yml` - Orquestra√ß√£o de containers
- `docker/Dockerfile` - Imagem da aplica√ß√£o

#### **Controllers Principais**
- `TaskController.php` - CRUD completo de tarefas + opera√ß√µes especiais
- `LogController.php` - Gerenciamento de logs e auditoria  
- `ApiDocumentationController.php` - Documenta√ß√£o OpenAPI/Swagger
- `HealthController.php` - Endpoints de verifica√ß√£o de sa√∫de do sistema

#### **Models**
- `Task.php` - Model principal com soft delete e valida√ß√µes
- `Log.php` - Model para MongoDB com logs de auditoria

#### **Valida√ß√£o e Requisi√ß√µes**
- `CreateTaskRequest.php` - Valida√ß√£o para cria√ß√£o de tarefas
- `UpdateTaskRequest.php` - Valida√ß√£o para atualiza√ß√£o
- `LogValidationRequest.php` - Valida√ß√£o para logs
- `FormRequest.php` - Base para valida√ß√£o de requisi√ß√µes
- `ValidationHelper.php` - Helpers de valida√ß√£o

#### **Configura√ß√µes Principais**
- `config/api.php` - Configura√ß√µes da API
- `config/database.php` - Configura√ß√µes de banco de dados
- `config/mongo.php` - Configura√ß√µes MongoDB
- `config/logging.php` - Configura√ß√µes de logging
- `config/validation_messages.php` - Mensagens de valida√ß√£o customizadas
- `config/errors.php` - Configura√ß√µes de tratamento de erros
- `config/log_responses.php` - Configura√ß√µes de resposta de logs

#### **Documenta√ß√£o**
- `/docs/` - Documenta√ß√£o t√©cnica detalhada (25+ guias)
- OpenAPI specs (arquivos `openapi-*.json`)
- Swagger UI integrado em `/public/swagger-ui/`

#### **Testes**
- M√∫ltiplos arquivos de teste para valida√ß√£o de API (40+ arquivos)
- Testes de integra√ß√£o com Docker
- Testes de seguran√ßa e valida√ß√£o
- Testes de inje√ß√£o SQL e sanitiza√ß√£o de dados

## üìÑ Licen√ßa

Este projeto est√° licenciado sob a [Licen√ßa MIT](LICENSE).

## üîÑ Hist√≥rico de Vers√µes

### v1.0.0
- API RESTful completa para gerenciamento de tarefas
- Sistema de soft delete e restaura√ß√£o
- Logging abrangente com MongoDB
- Documenta√ß√£o OpenAPI/Swagger
- Sistema avan√ßado de filtros e pagina√ß√£o
- Tratamento robusto de erros
- Rate limiting e valida√ß√£o

---